!function(n){"use strict";function t(n){this.name="IllegalArgumentError",this.message=n||""}function o(n){var o=typeof n.param;if(-1===n.types.indexOf(o)){var e=n.errorMsg||"Argument "+n.argName+" must be one of the following types: "+n.types.join(", ");throw new t(e)}}function e(n,t){function e(n,t,o){for(var e,r,a=0,i=n.length;i>a;a++)e=n[a],r=e.condition,("function"==typeof r&&r()||r)&&e.replacementFn.apply(t,o)}function r(n,t){if(t.condition){var o=n.atStart?"unshift":"push";Array.prototype[o].call(n.caseArr,t)}return t.condition}var a=n[t];o({param:a,types:["function"],errorMsg:"Cannot cloak property: "+t+", it is not a function"});var i,c={},s={},u=[],l=[];return s.lastWhenCondition=!0,i=n[t],n[t]=function(){i=i.bind(this);var n=Array.prototype.slice.call(arguments);s.cloaked||i.apply(this,n);var t=n.concat(i);e(u,this,t),e(l,this,t)},c.cloakWith=function(n){return o({param:n,types:["function"],argName:"fn"}),s.cloaked=!0,r({caseArr:u},{condition:s.lastWhenCondition,replacementFn:n}),c},c.when=function(n){return o({param:n,types:["function","boolean"],argName:"condition"}),s.lastWhenCondition=n,c},c.uncloak=function(){i&&(n[t]=i)},c.before=function(n){return o({param:n,types:["function"],argName:"fn"}),r({caseArr:u,atStart:!0},{condition:s.lastWhenCondition,replacementFn:n}),c},c.after=function(n){return o({param:n,types:["function"],argName:"fn"}),r({caseArr:l},{condition:s.lastWhenCondition,replacementFn:n}),c},c.callOriginal=function(){return r({caseArr:u},{condition:s.lastWhenCondition,replacementFn:i}),c},c.and=c,c}t.prototype=new Error,"undefined"!=typeof module&&module.exports?module.exports=e:window[n]=e}("cloak");